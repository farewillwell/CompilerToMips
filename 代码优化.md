# 代码优化

竞速排序最后一个点t了。。

必须优化了这下。。

## 乘除优化

### 常数优化：将常数的运算全算出来

#### 在哪里优化？

### 变量和常量计算

如果对于一个乘法mulExp，，其factor序列为a1,a2...an若前ai个均为常数，则这前ai个可以化简为一个常数

如果其中有一个0，则整个就是0

### 乘法优化

#### constant - constant

不生成指令，直接计算出来结果之后存到相应内存中

包括其他指令在内也一样

#### constant - x

通过shift比较计算

#### x - x

老老实实算吧

#### 除法优化

如果除的数是常数且为2的幂次，可以转化为sll

## CFG

首先解决的是跳转问题

比如在

```
if(a>1)
{
 b=b+1;
 return 0;
}
```

这个代码中，我会生成:

```
b1:
  ret i32 1
  br label %b3
b2:
  ret i32 2
  br label %b3
```

这种形式的，这显然是会错误估计支配边界的。

因此，我们做一个检查，对于一个block，如果遇到了一个离开指令，那么删除后面所有的代码。

## 寄存器分配

之前在mips生成的时候，为了方便，我一直用的是全部把数据存到内存中。
